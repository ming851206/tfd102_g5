<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>後台主頁</title>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        .switchIo {
            background-image: url(../images/icon/toggle_off.svg) !important;
        }

        .fadeOut {
            opacity: 0 !important;
        }
    </style>
</head>

<body>
    <section class="adm_sec">
        <div id="app">
            <div class="adm_flexbox">
                <div class="adm_appl">
                    <router-link to="/trip" @click.native="init">旅程管理</router-link>
                    <router-link to="/order" @click.native="init">旅程訂單管理</router-link>
                    <router-link to="/coupon" @click.native="init">優惠券管理</router-link>
                    <router-link to="/faq" @click.native="init">問題意見管理</router-link>
                    <router-link to="/member" @click.native="init">會員管理</router-link>
                </div>
                <div class="adm_appr">
                    <div class="adm_above">
                        <h4>Hi!Jumper</h4>
                        <button class="btnM" type="button"><a href="../php/adm_logout.php">登出</a></button>
                    </div>
                
                    <router-view></router-view>
                </div>
            </div>
        </div>
    </section>
    <script src="../js/jq/jquery-3.6.0.js"></script>
    <script src="../js/vue/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue-router/3.5.2/vue-router.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vuex/3.6.2/vuex.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/emailjs-com@2.3.2/dist/email.min.js"></script>
    <script type="text/javascript">
        (function () {
            emailjs.init("user_q03YE628F7CYJOygI92dH");
        })();
    </script>

    <!--各元件引入-->
    <script src="../js/admin_index/coupon.js"></script>
    <script src="../js/admin_index/faq.js"></script>
    <script src="../js/admin_index/member.js"></script>
    <script src="../js/admin_index/child_triplist.js"></script>
    <script src="../js/admin_index/child_tripcheck.js"></script>
    <script src="../js/admin_index/child_orderlist.js"></script>
    <script src="../js/admin_index/child_commentchk.js"></script>
    <script src="../js/admin_index/child_newcoupon.js"></script>
    <script>
        // var timestampMixin = {
        //     data() {
        //         return {
        //             timestamp: ''
        //         }
        //     },
        //     methods: {
        //         timestampToTime(timestamp) {

        //             var date = new Date(timestamp * 1000);//時間戳為10位需*1000，時間戳為13位的話不需乘1000
        //             Y = date.getFullYear() + '/';
        //             M = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + '/';
        //             D = date.getDate() + ' ';
        //             h = date.getHours() + ':';
        //             m = date.getMinutes() + ':';
        //             s = date.getSeconds();
        //             return this.timestamp = Y + M + D;

        //         }
        //         // filterList(data) { //實驗中 
        //         //     // return this.data.filter((dataTr) => { //把data送下來使用filter功能
        //         //     //     return dataTr.dataTd.includes(this.search);
        //         //     // })
        //         //         console.log(this.data[0].ID);
        //         // },
        //     }
        // }
        Vue.use(VueRouter);

        // ========== 旅程管理(綺) ============= 
        const Trip = {
            template: `
                <div>
                    <div class="linkGroup">
                        <router-link to="/trip" class="topA">旅程列表</router-link>
                        <router-link to="/trip/tripCheck" class="topA">旅程申請審核</router-link>
                    </div>
                    <router-view></router-view>
                </div>
        ` };
        // ========== 旅程訂單管理(竹) ========== 
        const Order = {
            template: `
                <div>
                    <div class="linkGroup">
                        <router-link to="/order" class="topA">訂單管理</router-link>
                        <router-link to="/order/commentCheck" class="topA">旅程評論審查</router-link>
                    </div>
                    <router-view></router-view>
                </div>
        ` };
        //======================================
        const router = new VueRouter({
            mode: 'history',
            routes: [
                {
                    path: '/trip',
                    component: Trip,
                    children: [ //設定子路徑
                        { path: '', component: TripList }, //子路徑前面不要再寫/
                        { path: 'tripCheck', component: TripCheck },
                    ],
                },
                {
                    path: '/order',
                    component: Order,
                    children: [ //設定子路徑
                        { path: '', component: OrderList }, //子路徑前面不要再寫/
                        { path: 'commentCheck', component: CommentCheck },
                    ],
                },
                {
                    path: '/coupon',
                    component: Coupon,
                    // children: [
                    //     { path: 'newCoupon', component: NewCoupon },
                    // ]
                },
                {
                    path: '/coupon/newCoupon',
                    component: NewCoupon,
                    // children: [
                    //     { path: 'newCoupon', component: NewCoupon },
                    // ]
                },

                {
                    path: '/faq',
                    component: Faq,
                },
                {
                    path: '/member',
                    component: Member,
                },

            ],
        })

        new Vue({
            el: '#app',
            router,
            methods: {
                init(){
                    axios.post('../php/adm_loginCheck.php')
                    .then(res => {
                        if(res==""){
                            alert('請先登入!');
                            location.href = '../admin/login.html'; 
                        }else{
                            console.log('登入過了');
                        }
                    })
                    .catch( (error) => alert('數據加載失敗'+ error));
                },
            },
        });
    </script>