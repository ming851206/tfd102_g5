<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>後台主頁</title>
    <link rel="icon" href="../images/logo/favicon.ico.png" type="image/x-icon">
    <link rel="stylesheet" href="../css/style.css">
    <style>
        .switchIo {
            background-image: url(../images/icon/toggle_off.svg) !important;
        }

        .fadeOut {
            opacity: 0 !important;
        }
    </style>
</head>

<body>
    <div id="app">
        <section class="adm_sec">
            <div class="adm_flexbox">
                <div class="adm_appl">
                    <a href="../home.html" class="logo">
                        <img src="../images/logo/logo-circle.png" alt="">
                    </a>
                    <router-link to="/tfd102/project/g5/admin/trip" @click.native="init"
                        :class="{'is_active':current_category === '/tfd102/project/g5/admin/trip'}">
                        旅程管理</router-link>
                    <router-link to="/tfd102/project/g5/admin/order" @click.native="init"
                        :class="{'is_active':current_category === '/tfd102/project/g5/admin/order'}">
                        旅程訂單管理</router-link>
                    <router-link to="/tfd102/project/g5/admin/coupon" @click.native="init"
                        :class="{'is_active':current_category === '/tfd102/project/g5/admin/coupon'}">優惠券管理
                    </router-link>
                    <router-link to="/tfd102/project/g5/admin/faq" @click.native="init"
                        :class="{'is_active':current_category === '/tfd102/project/g5/admin/faq'}">
                        問題意見管理</router-link>
                    <router-link to="/tfd102/project/g5/admin/member" @click.native="init"
                        :class="{'is_active':current_category === '/tfd102/project/g5/admin/member'}">會員管理</router-link>
                </div>
                <div class="adm_appr">
                    <div class="adm_above">
                        <h4>Hi!Jumper</h4>
                        <button class="btnM" type="button" @click="chkBtn" id="loginChk">登出</button>
                    </div>

                    <router-view></router-view>
                </div>
            </div>
    </div>
    </div>
    </section>
    <script src="../js/jq/jquery-3.6.0.js"></script>
    <script src="../js/vue/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue-router/3.5.2/vue-router.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vuex/3.6.2/vuex.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/emailjs-com@2.3.2/dist/email.min.js"></script>
    <script type="text/javascript">
        (function () {
            emailjs.init("user_q03YE628F7CYJOygI92dH");
        })();
    </script>

    <!--各元件引入-->
    <script src="../js/admin_index/timestampMixin.js"></script>
    <script src="../js/admin_index/coupon.js"></script>
    <script src="../js/admin_index/faq.js"></script>
    <script src="../js/admin_index/member.js"></script>
    <script src="../js/admin_index/child_triplist.js"></script>
    <script src="../js/admin_index/child_tripcheck.js"></script>
    <script src="../js/admin_index/child_orderlist.js"></script>
    <script src="../js/admin_index/child_commentchk.js"></script>
    <script src="../js/admin_index/child_newcoupon.js"></script>
    <script>
        Vue.use(VueRouter);

        // ========== 旅程管理(綺) =============
        const Trip = {
            template: `
                <div>
                    <div class="linkGroup">
                        <router-link to="/tfd102/project/g5/admin/trip" class="topA" :class="{'isActive': work == 'list'}" @click.native=" work = 'list'">旅程列表</router-link>
                        <router-link to="/tfd102/project/g5/admin/trip/tripCheck" class="topA" :class="{'isActive': work == 'check'}" @click.native=" work = 'check' ">旅程申請審核</router-link>
                    </div>
                    <router-view></router-view>
                </div>
        ` ,
            data() {
                return {
                    work: 'list',
                }
            },
        };
        // ========== 旅程訂單管理(竹) ==========
        const Order = {
            template: `
                <div>
                    <div class="linkGroup">
                        <router-link to="/tfd102/project/g5/admin/order" class="topA" :class="{'isActive': work == 'orderlist'}" @click.native=" work = 'orderlist'">訂單管理</router-link>
                        <router-link to="/tfd102/project/g5/admin/order/commentCheck" class="topA" :class="{'isActive': work == 'cmtCheck'}" @click.native=" work = 'cmtCheck'">旅程評論審查</router-link>
                    </div>
                    <router-view></router-view>
                </div>
        ` ,
            data() {
                return {
                    work: 'orderlist',
                }
            },
        };
        const router = new VueRouter({
            mode: 'history',
            routes: [
                {
                    path: '/tfd102/project/g5/admin/trip',
                    component: Trip,
                    children: [ //設定子路徑
                        { path: '', component: TripList }, //子路徑前面不要再寫/
                        { path: 'tripCheck', component: TripCheck },
                    ],
                },
                {
                    path: '/tfd102/project/g5/admin/order',
                    component: Order,
                    children: [ //設定子路徑
                        { path: '', component: OrderList }, //子路徑前面不要再寫/
                        { path: 'commentCheck', component: CommentCheck },
                    ],
                },
                {
                    path: '/tfd102/project/g5/admin/coupon',
                    component: Coupon,
                    // children: [
                    //     { path: 'newCoupon', component: NewCoupon },
                    // ]
                },
                {
                    path: '/tfd102/project/g5/admin/coupon/newCoupon',
                    component: NewCoupon,
                    // children: [
                    //     { path: 'newCoupon', component: NewCoupon },
                    // ]
                },

                {
                    path: '/tfd102/project/g5/admin/faq',
                    component: Faq,
                },
                {
                    path: '/tfd102/project/g5/admin/member',
                    component: Member,
                },

            ],
        })

        new Vue({
            el: '#app',
            router,
            data: {
                current_category: '/tfd102/project/g5/admin/trip',
            },
            methods: {
                init(e) {
                    //console.log(e.target.getAttribute('href'));
                    this.current_category = e.target.getAttribute('href'); //加class,current_cate = href

                    axios.post('../php/adm_loginCheck.php')
                        .then(res => {
                            if (res.data == "") {
                                alert('請先登入!');
                                location.href = '../admin/login.html';

                            }
                        })
                        .catch((error) => alert('數據加載失敗' + error));

                },
                chkBtn() {
                    axios.post('../php/adm_loginCheck.php')
                        .then(res => {
                            if (res.data == "") {
                                document.getElementById('loginChk').innerText = '登入';
                                location.href = '../admin/login.html';
                            } else {
                                document.getElementById('loginChk').innerText = '登出';
                                location.href = '../php/adm_logout.php';
                            }
                        })
                        .catch((error) => alert('數據加載失敗' + error));
                },
            },
            mounted() {
                axios.post('../php/adm_loginCheck.php')
                    .then(res => {
                        if (res.data == "") {
                            document.getElementById('loginChk').innerText = '登入';
                        } else {
                            document.getElementById('loginChk').innerText = '登出';
                        }
                    })
                    .catch((error) => alert('數據加載失敗' + error));
                document.getElementsByClassName('is_active')[0].click();

                // let preSet = document.getElementsByTagName('a')[0];
                // preSet.click();//預選第一個項目第一頁
            },
        });
    </script>